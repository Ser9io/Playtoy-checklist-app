<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="icon" href="logo.png">

    <title>Checklist Otimizado - Playtoy Park</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; padding: 15px; background: #f4f7f6; text-align: center; }
        .header-box { background: white; padding: 15px; border-bottom: 4px solid #1a73e8; margin-bottom: 20px; }
        .container { max-width: 600px; margin: auto; }
        .card { background: white; border: 1px solid #ddd; padding: 18px; margin-bottom: 15px; border-radius: 12px; text-align: left; }
        .thumb-container { position: relative; display: inline-block; margin: 5px; }
        .thumb { width: 90px; height: 90px; object-fit: cover; border-radius: 8px; border: 2px solid #1a73e8; }
        .btn-del { position: absolute; top: -5px; right: -5px; background: red; color: white; border-radius: 50%; width: 20px; height: 20px; border: none; font-size: 12px; cursor: pointer; }
        textarea { width: 100%; height: 70px; border-radius: 8px; border: 1px solid #ccc; padding: 10px; box-sizing: border-box; margin-top: 10px; }
        .btn-save { background: #28a745; color: white; padding: 18px; width: 100%; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 20px; }
        .loading-msg { color: #1a73e8; font-weight: bold; display: none; margin-bottom: 10px; }
    </style>
</head>

<link rel="manifest" href="manifest.json">

<body onload="carregarDadosExistentes()">

<div class="header-box">
    <h2 id="txtMaq">---</h2>
    <p>Unidade: <span id="txtLoja">---</span></p>
</div>

<div class="container">
    <div class="card">
        <strong>T칠cnico Respons치vel:</strong>
        <input type="text" id="tecnico" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc; box-sizing: border-box;">
    </div>

    <div id="listaPerguntas">
        <div class="card" style="background:#fff3cd;">
            <strong>1. A m치quina est치 funcionando?</strong><br><br>
            <input type="radio" name="p0" value="Sim"> Sim &nbsp;&nbsp;          
            <input type="radio" name="p0" value="N칚o"> N칚o
        </div>
    </div>

    <div class="card">
        <strong>游닞 Registro Fotogr치fico (Fotos Comprimidas)</strong><br><br>
        <p style="font-size: 11px; color: #666;">As fotos s칚o reduzidas automaticamente para caber mais no sistema.</p>
        <input type="file" id="inputFoto" accept="image/*" capture="camera" multiple onchange="processarFotos(this)">
        <div id="loading" class="loading-msg">Comprimindo imagens... aguarde.</div>
        <div id="galeria" style="margin-top: 10px;"></div> 
        <textarea id="comentarioFoto" placeholder="Detalhes t칠cnicos ou observa칞칫es..."></textarea>
    </div>

    <button class="btn-save" onclick="salvar()">游 SALVAR CHECKLIST</button>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const maquina = params.get("maq") || "";
    const loja = params.get("loja") || "";
 // Cria a data no fuso hor치rio de Bras칤lia (ou local do dispositivo) formatada como AAAA-MM-DD
    const dataHoje = new Date().toLocaleDateString('sv-SE');   

    document.getElementById("txtMaq").innerText = maquina;
    document.getElementById("txtLoja").innerText = loja;

/* ================= M츼QUINAS E SEUS CHECKLISTS ================= */

    const checklists = {
	
               /* ================= GRUPO GRUAS ================= */
      
        "Grua Simples Neo Carnival A": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Simples Neo Carnival B": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Simples Neo Carnival 181": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Simples Neo Carnival 183": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Simples Neo Carnival 381": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Simples Neo Carnival 384": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Dupla Neo Carnival": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Dupla Neo Carnival 268 A e B": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Dupla Neo Carnival 267 A e B": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],
        "Grua Max Claw": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "O bot칚o de descer a garra esta funcionando direito?"],
        "Grua Top Machine": ["Existe algum display na m치quina falhando?", "O bot칚o do jogo est치 funcionando direito?"],
        "Super Bicho Feliz": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "O bot칚o de descer a garra esta funcionando direito?"],
        "Grua Top Modern Game": ["Existe algum display na m치quina falhando?", "A alavanca est치 funcionando direito?", "Os bot칫es de descer a garra e de movimentar os bichos acendem e est칚o funcionando?"],

               /* ================= GRUPO TOT칍 ================= */
		
		"Playgol": ["Existe alguma vareta agarrando?", "A bola do jogo est치 em bom estado?", "Existe algum display com defeito?"],
		"Futeboys": ["Existe algum boneco frouxo ou quebardo", "A bola do jogo est치 em bom estado?", "Existe algum display com defeito?", "Existe alguma vareta agarrando?", "A bola do jogo est치 em bom estado?"],

		       /* ================= GRUPO COLETIVO ================= */
		
		"Peixinho": ["Tem alguma cabine danificada?", "Existe algum cinto danificado", "Existe alguma trava de alguma nave danificada?",  "O port칚o de acesso est치 travando?"],
		"Auto Pista Bate-bate": ["O display est치 funcionando", "Tem algum carrinho parado ou falhando?", "Existe algum cinto danificado", "Os pneus est칚o calibrados", "Os volantes e os bancos est칚o em bons estados", "A pista esta em bom estado?", "O port칚o de acesso esta travando?"],

		       /* ================= GRUPO GALERIAS ================= */
		"Saloon": ["A im치gem da m치quina est치 boa?", "A armas est칚o funcionando?", "Est치 saindo som de disparo ao atirar?", "Existe algum efeito que n칚o funciona?", "A parte onde fica os tickets e dispenser est치 sujo?"],
		"Toy Town": ["A armas est칚o funcionando?", "Est치 saindo som de disparo ao atirar?", "Existe algum efeito que n칚o funciona?", "A parte onde fica os tickets e dispenser est치 sujo?", "O compressor est치 funcionando", "Tem algum display falhando ou apagado?", "As armas est칚o em bom estado?"],
		"Patrulha Estelar": ["A armas est칚o funcionando?", "O lazer est치 ok ?", "Est치 saindo som de disparo ao atirar?", "Existe algum efeito que n칚o funciona?", "A parte onde fica os tickets e dispenser est치 sujo?"],
		
               /* ================= GRUPO FLIPERAMA ================= */

		"The King 97": ["A im치gem da m치quina est치 boa?", "As alavancas est칚o funcionando direito?", "Todos os bot칫es est칚o funcionando?", "Existe algum bot칚o falhando?"],
		"The King 2002": ["A im치gem da m치quina est치 boa?", "As alavancas est칚o funcionando direito?", "Todos os bot칫es est칚o funcionando?", "Existe algum bot칚o falhando?"],
        "Multijogos Pandora": ["A im치gem da m치quina est치 boa?", "As alavancas est칚o funcionando direito?", "Todos os bot칫es est칚o funcionando?", "Existe algum bot칚o falhando?"],
		

               /* ================= GRUPO KID RIDER ================= */

		"Kid Rider TD": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
        "Kid Rider Nemo": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?", "A im치gem da m치quina est치 boa?", "O joystick est치 funcionando direito?", "O bot칚o est치 funcionando?"],
		"Kid Rider Train": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
        "Kid Rider Vs Drago": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?","A im치gem da m치quina est치 boa?", "A corrente est치 funcionando direito para esquerda e direita e ao puxar durante o jogo?"],
        "Kid Rider Trem Azul": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?","A im치gem da m치quina est치 boa?", "O volante est치 funcionando?", "O pedal est치 funcionando?"],
		"Kid Rider Jeep Azul": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
		"Kid Rider Race Space": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
		"Kid Rider Carro Galo": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?", "O bot칚o est치 funcionando?"],
		"Kid Rider Carr칚o Azul": ["A m치quina est치 balan칞ando?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
        "Kid Rider Avi칚o Apache": ["O equipamento inclina para os lados de acordo com o volante?", "Existe algum ru칤do durante o balan칞o do equipamento?","A im치gem da m치quina est치 boa?"],
		"Kid Rider Barco Pirata": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?", "A im치gem da m치quina est치 boa?", "O bot칚o est치 funcionando?"],
		"Kid Rider Carro Amarelo": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
		"Kid Rider Carro Vermelho": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?"],
		"Kid Rider Jet Skee Amarelo": ["A m치quina est치 balan칞ando durante o jogo?", "Existe algum ru칤do durante o balan칞o do equipamento?", "A im치gem da m치quina est치 boa?", "O bot칚o est치 funcionando?"],
		
               /* ================= GRUPO AIR-GAME ================= */

        "Air Game Presas": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
		"Air Game Malware A": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
        "Air Game Malware B": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
        "Air Game Malware C": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
		"Air Game Free Style": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
        "Air Hockey Pac-man A": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
        "Air Hockey Pac-man B": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],
        "Air Hockey Pac-man C": ["Existe algum display na m치quina falhando?", "Existe algum erro no display?", "As portas est칚o prendendo o disco?", "O disco que se encontra na m치quina est치 bom e deslizando?", "O fluxo do ar sobre a mesa est치 normal?"],

               /* ================= GRUPO CABINADAS ================= */

		"Aliens": ["A im치gem da m치quina est치 boa?", "Os bot칫es de start acendem quando tem cr칠dito e est칚o funcionando?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o vibrando ao atirar?", "As armas da m치quina est칚o calibradas?"],
        "Transformers": ["A im치gem da m치quina est치 boa?", "Os bot칫es de start acendem quando tem cr칠dito e est칚o funcionando?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o vibrando ao atirar?", "As armas da m치quina est칚o calibradas?"],
        "Jurassic Park": ["A im치gem da m치quina est치 boa?", "Os bot칫es de start acendem quando tem cr칠dito e est칚o funcionando?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o vibrando ao atirar?", "As armas da m치quina est칚o calibradas?"],
		"Deadstorn Pirates": ["A im치gem da m치quina est치 boa?", "Os bot칫es de start acendem quando tem cr칠dito e est칚o funcionando?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o vibrando ao atirar?", "As armas da m치quina est칚o calibradas?", "O tim칚o est치 bom?"],
		"The House of the Dead 4": ["A im치gem da m치quina est치 boa?", "Os bot칫es de start acendem quando tem cr칠dito e est칚o funcionando?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o vibrando ao atirar?", "As armas da m치quina est칚o calibradas?"],

               /* ================= GRUPO SIMULADORES ================= */

		"Super bikes 2": ["A im치gem da m치quina est치 boa?", "Existe algum display na m치quina falhando?", "Os bot칫es do painel est칚o funcionando?", "O banco da moto se encontra inclinada para algum lado?", "A jogabilidade ao inclinar a moto esta boa no jogo?"],
        "Super Bikes 2 A": ["A im치gem da m치quina est치 boa?", "Existe algum display na m치quina falhando?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O banco da moto se encontra inclinada para algum lado?", "As molas est칚o boas?", "A jogabilidade ao inclinar a moto esta boa no jogo?", "O teclado num칠rico esta funcionando?"],
        "Super Bikes 2 B": ["A im치gem da m치quina est치 boa?", "Existe algum display na m치quina falhando?", "O link da m치quina esta ok?", "Os bot칫es do painel est칚o funcionando?", "O banco da moto se encontra inclinada para algum lado?", "As molas est칚o boas?", "A jogabilidade ao inclinar a moto esta boa no jogo?", "O teclado num칠rico esta funcionando?"],
		"Manx TT A": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "A inclina칞칚o do banco est치 respondendo bem no jogo?", "O freio funciona?", "O acelerador funciona?", "A l칙mpada de Race Leader est치 funcionando?"],
		"Manx TT B": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "A inclina칞칚o do banco est치 respondendo bem no jogo?", "O freio funciona?", "O acelerador funciona?", "A l칙mpada de Race Leader est치 funcionando?"],
		"ATV Track": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O guid칚o est치 respondendo bem no jogo?", "As 2 manetes de freio funciona?", "O acelerador funciona?", "A simula칞칚o do banco est치 funcionando?", "Simula칞칚o do guid칚o est치 funcionando?", "Existe algum cabo de a칞o arrebentado?"],
		"Wave Runner": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O guid칚o est치 respondendo bem no jogo?", "O acelerador funciona?", "O acento est치 em bom estado?"],
		"Wave Shark": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O guid칚o est치 respondendo bem no jogo?", "O acelerador funciona?"],

		"Drift A": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Drift B": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
        "Dead Head A": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?", "O teclado num칠rico esta funcionando?"],
        "Dead Head B": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?", "O teclado num칠rico esta funcionando?"],
		"Wack Race A": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?"],
		"Wack Race B": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?"],
		"Sega Rally A": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?", "A l칙mpada de Race Leader est치 funcionando?"],
		"Sega Rally B": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?", "A l칙mpada de Race Leader est치 funcionando?"],
        "Super Speed A": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "O acr칤lico vermelho do assoalho est치 limpo e aceso", "A marcha est치 funcionando?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
        "Super Speed B": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "O acr칤lico vermelho do assoalho est치 limpo e aceso", "A marcha est치 funcionando?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Nicktoons Nitro A": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?"],
		"Nicktoons Nitro B": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?"],
		"Need For Speed Carbon A": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Need For Speed Carbon B": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],

		"Cruis'is USA": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Cruis'is USA A": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Cruis'is USA B": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Cruis'is World 50": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],

		"Daytona USA A (Galp칚o)": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Daytona USA B (Galp칚o)": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Daytona USA A (Esportivo)": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?", "A l칙mpada de Race Leader est치 funcionando?"],
		"Daytona USA B (Esportivo)": ["A im치gem da m치quina est치 boa?", "O link da m치quina est치 ok?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?", "A l칙mpada de Race Leader est치 funcionando?"],

		"Seninha": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Out Run 2": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?"],
		"Midnight Run": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Off Road challenge": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"S칚o Francisco Rush": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?", "Simula칞칚o do volante est치 funcionando?"],
		"Sonic All Star Race": ["A im치gem da m치quina est치 boa?", "Os bot칫es do painel est칚o funcionando?", "O volante est치 respondendo bem no jogo?", "O pedal de freio funciona?", "O pedal de acelerador funciona?", "A regulagem do banco est치 funcionando?"],

        "Rilix": ["A im치gem da m치quina est치 boa?", "Os 칩culos est칚o conectados?", "O efeito de vento est치 funcionando?"],
		"Guitar Hero": ["A im치gem da m치quina est치 boa?", "A guitarra est치 funcionando e em bom estado?", "O display do temporizador est치 ok?"],
		"Pump Fiesta 2010": ["A im치gem da m치quina est치 boa?", "As setas do tapete est칚o boas e funcionando?", "Tem algo soltando no tapete?", "O V.U. da m치quina est치 ok?"],
		"Aliens Extermination": ["A im치gem da m치quina est치 boa?", "Os bot칫es de start acendem quando tem cr칠dito e est칚o funcionando?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o vibrando ao atirar?", "As armas da m치quina est칚o calibradas?"],
		
               /* ================= GRUPO REDEMPTIONS ================= */

        "MIB": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?"],
		"Wild West": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "As armas est칚o calibradas?", "As armas est칚o com as bobinas do recuo funcionando?", "As armas est칚o bem presas pelo cabo de a칞o?"],
        "Zumbi Land Battle": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?"],

		"Diverkids": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "As bolas est칚o muchas?"],
        "Castle Attack": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e Dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "Os alvos est칚o marcando?", "As bolas est칚o muchas?"],
		"Bionic Basketball": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "A cesta est치 se movimentando no est치gio 2?", "As bolas est칚o muchas?"],
        "Street Basketball A": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "A cesta est치 se movimentando no est치gio 2? (Precisa fazer 40 pontos no primeiro est치gio)", "As bolas est칚o muchas?"],
        "Street Basketball B": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "A cesta est치 se movimentando no est치gio 2? (Precisa fazer 40 pontos no primeiro est치gio)", "As bolas est칚o muchas?"],
		"Street Basketball Vermelha": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "A cesta est치 se movimentando no est치gio 2? (Precisa fazer 40 pontos no primeiro est치gio)", "As bolas est칚o muchas?"],

        "Cyclone": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os bot칫es est칚o funcionando?", "Existe alguma l칙mpada queimada do jogo?", "Os neons est칚o acendendo direito?"],
        "Duo Drive": ["A im치gem da m치quina est치 boa?", "A m치quina est치 com som?", "A parte onde fica os tickets e dispenser est치 sujo?", "O volante est치 funcionando direito?"],
        "Sonic Dash": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "Todos os bot칫es est칚o funcionando?"],
        "Super Wings": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os manches est칚o funcionado pra direita e para a esquerda e quando ele 칠 puchado?"],
        "Pirate Hook": ["A im치gem da m치quina est치 boa?", "O display da m치quina no cabe칞ote est치 ok?", "A parte onde fica os tickets e dispenser est치 sujo?", "O bot칚o das manivelas est치 funcionado?", "As manivelas est칚o funcionando?", "As manivelas est칚o fazendo algum ruido alto ao girar?"],
		"Target Zero": ["A parte onde fica os tickets e dispenser est치 sujo?", "O volante est치 funcionando direito?"],
		"Fishing Fun": ["A parte onde fica os tickets e dispenser est치 sujo?", "O manche est치 funcionando normalmente?", "Os 3 bot칫es do manche est칚o bons?"],
		"Mouse Attack": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "O bot칚o do start est치 bom?"],

		"Hammer 2": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "Est치 falhando ao bater na tela?", "O vidro e a tv est칚o sujos?", "Os martelos est칚o em bom estado?"],
		"Feed Fido": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os 3 cachorros est칚o em bons estados?", "Os 3 cachorros est칚o com os movimentos ok?", "Os ossos est칚o em bom estado?"],
        "Crazy Frog": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os sapinhos est칚o soltos ou frouxos?", "Os sapinhos est칚o todos subindos durante o jogo?"],
		"Hoop It Up": ["A parte onde fica os tickets e dispenser est치 sujo?", "Alguma bolinha quebrada dentro da m치quina?", "Aonde bate para lan칞ar as bolas est치 rasgada ou danificada?", "As cestas est칚o marcando?", "Existe algum display falhando na m치quina?"],
		"Wacky Gator": ["A parte onde fica os tickets e dispenser est치 sujo?", "Algum Jacar칠 n칚o est치 se movimentando?", "Algum Jacar칠 n칚o est치 marcando ponto?", "Existe algum display falhando na m치quina?"],
		"Hipo Jungle": ["A parte onde fica os tickets e dispenser est치 sujo?", "Algum Hipop칩tamo n칚o est치 se movimentando?", "Algum Hipop칩tamo n칚o est치 marcando ponto?", "Existe algum display falhando na m치quina?"],
        "Fright Night": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os bonecos est칚o subindo direito?", "Os bonecos est칚o marcando ponto ao serem acertados?", "O martelo est치 em bom estado e bem preso pela corda?", "Existe algum erro no display da m치quina?"],
		"Kung Fu Panda": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "Todos os alvos est칚o marcando?"],
        "Pac Man Hammer": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os bonecos est칚o subindo direito?", "Os bonecos est칚o marcando ponto ao serem acertados?", "O martelo est치 em bom estado e bem preso pela corda?", "Existe algum erro no display da m치quina?"],

        "Ace Man": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o com a sa칤da d'치gua com fluxo normal?", "A grama de pl치stico da m치quina est치 em bom estado?", "O efeito de fuma칞a d'치gua est치 funcionando?"],
		"Fire Heros": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "As armas da m치quina est칚o calibradas?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o com a sa칤da da 치gua com fluxo normal?"],
		"Ocean Panic": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "O fluxo da 치gua est치 ok?", "Todos os alvos est칚o marcando?"],
        "Duck Splash": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "Tem 4 patinhos em cada lado?", "O fluxo de 치gua nas pistolas est치 bom?", "Ao jogar de um lado, sai 치gua na outra pistola?", "Pistola e grade est칚o frouxas?"],
		"Rescue One!": ["A parte onde fica os tickets e dispenser est치 sujo?", "Os alvos est칚o marcando?", "A sa칤da d'치gua da pistola est치 com o fluxo?", "Existe algum display falhando na m치quina?", "O bombeiro est치 subindo?", "O cabo de a칞o est치 normal?"],
		"Surfin Ducks": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "Tem 4 patinhos em cada lado?", "O fluxo de 치gua nas pistolas est치 bom?", "Ao jogar de um lado, sai 치gua na outra pistola?", "Pistola e grade est칚o frouxas?"],
		"Corrida Maluca": ["A parte onde fica os tickets e dispenser est치 sujo?", "Os alvos est칚o marcando?", "A sa칤da da 치gua nas pistolas est치 normal o fluxo?", "Ao iniciar o jogo em apenas um dos lados, a 치gua sai na outra arma?", "Os palha칞os est칚o em bons estado?", "Existe algum display falhando na m치quina?"],
        "Dinosaur World": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o com a sa칤da d'치gua com fluxo normal?", "A grama de pl치stico da m치quina est치 em bom estado?"],
        "Fun In The Inks": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o com a sa칤da d'치gua com fluxo normal?", "A grama de pl치stico da m치quina esta em bom estado?"],
		"Zombie Outbreak": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A 치gua e o filtro est칚o limpos?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?", "As armas est칚o com a sa칤da d'치gua com fluxo normal?", "A grama de pl치stico da m치quina est치 em bom estado?"],
		"Ataque dos Tubar칫es": ["A parte onde fica os tickets e dispenser est치 sujo?", "Os alvos est칚o marcando?", "A sa칤da d'치gua nas pistolas est칚o normais o fluxo?", "Ao iniciar o jogo em apenas um dos lados, a 치gua sai na outra arma?", "Os peixes est칚o em bons estado?", "Existe algum display falhando na m치quina?"],

        "Rainbow": ["O display da m치quina est치 funcionando com alguma falha ou n칚o funciona?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "Ao ligar a m치quina e ao levantar a porta, a m치quina arma o compressor sem ter bolinhas para subir?", "As bolas est칚o com dificuldade de subir?", "A m치quina est치 com algum erro no display, sem ser o erro 6 ou o erro 7?"],
		"Chuva de Bolinha": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Tem bolas suficiente na m치quina?", "O prato girat칩rio est치 em bom estado?", "O fluxo das bolas subindo est치 bom?"],
        "Drago": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "As asas do drago est칚o funcionando?"],
		"Ice Ball": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "Os alvos est칚o todos marcando?"],
		"Atl칙ntida": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os baldes est칚o girando normalmente?", "Os baldes est칚o marcando?", "A trava das bolinhas est치 ok?", "Tem bolinhas suficiente na m치quina?", "Os bot칫es de start esta acendendo e funcionando?"],
        "Girafeplay": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Todos os dentes est칚o em p칠?", "Existe algum dente quebrado?", "Os dentes est칚o marcando ponto ao serem acertados?", "Existe algum erro no display?"],
		"Saltin Ball": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "Os alvos est칚o todos marcando?"],
        "Happy Soccer": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os lan칞adores das bolas est칚o com for칞a suficiente para fazer o gol?", "As 4 bolas do jogo est칚o em bom estado?"],
        "Sonho de Mel": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Ao iniciar a partida, j치 aparece ponto sem ter acertado alguma abelha?", "As abelhas est칚o marcando ao serem acertadas?", "A trava das bolas est치 funcionando?", "O acr칤lico vermelho do display saiu do lugar?"],
        "Bowling Champ": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A jogabilidade est치 boa?"],
        "Galaxy Travel": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "O lazer et치 funcinando?", "Os bot칫es das armas est칚o funcionando?", "Todos os bonecos est칚o funcionando?", "Bonecos est칚o caindo ao serem acertados?", "A sensibilidade da arma ao acertar os bonecos est치 boa?"],
        "Super Soldier": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os bonecos est칚o marcando ponto ao serem acertados?", "O fluxo de bolinhas esta saindo bem na pistola durante o jogo?"],
		"Ghost Bowling": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "A jogabilidade est치 boa?"],
		"Patati Patat치": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 ok?", "Os alvos est칚o toods marcando?", "O Elefante esta se movimentando?", "O bot칚o de starte esta acendendo e funcionando?"],
        "Dinosaurs Park": ["A im치gem da m치quina est치 boa?", "A parte onde fica os tickets e dispenser est치 sujo?", "As armas da m치quina est칚o calibradas?", "As armas est칚o vibrando ao atirar?", "Os bot칫es das armas est칚o funcionando?", "O fluxo de sa칤da de bolinhas nas armas est치 boa?"],
        "Astro Invasion": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "Os bonecos est칚o marcando pontos ao serem acertados?", "Os bonecos maiores est칚o subindo e descendo e balan칞ando de uma lado para o outro?", "A trava das bolas est치 funcionando?", "O alvo de cima esta com o foguete na ponta e girando?", "O alvos de cima est칚o marcando pontos"],
		"Seeking Treasute": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A arma est치 com press칚o?", "Os tubar칫es est칚o funcionando e marcando ponto?", "O bot칚o de start esta acendendo e funcionando?"],
		"NBA Championships": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "As bolinhas est칚o em bom estado?", "as cestas est칚o em bom estado e marcando ponto?", "As cestas est칚o se movimentando?", "Os lan칞adores das bolas est칚o com press칚o?", "Os motores de movimentar as bolas est칚o funcionando", "Os bot칫es dos lancedore est칚o acendnendo e funcionando?"],
		"Castelo do Monstro": ["Existe algum display na m치quina falhando?", "A parte onde fica os tickets e dispenser est치 sujo?", "A trava das bolas est치 funcionando?", "Os alvos est칚o todos marcando?"]

    };

// 1. Definimos as perguntas padr칚o que aparecem em TODOS os equipamentos
    const perguntasPadrao = ["Algo frouxo na m치quina ou com algum parafuso faltando?", "O cabe칞ote est치 aceso?", "Existe alguma ilumina칞칚o na m치quina (incluindo led), apagada ou falhando?", "A leitora est치 lendo o cart칚o normalmente?", "O display da leitora est치 bom?", "A m치quina est치 com som?", "A m치quina est치 limpa?", "Tem algum adesivo danificado na m치quina?", "A est칠tica da m치quina, em geral, est치 boa?", "Existe informativos de como jogar ou de pontua칞칚o na m치quina?"];

    // 2. Pegamos as perguntas espec칤ficas da m치quina (se existirem)
    const perguntasEspecificas = checklists[maquina] || [];

    // 3. Juntamos as duas: as padr칚o v칡m PRIMEIRO
    const perguntasExtras = [...perguntasPadrao, ...perguntasEspecificas];

    const container = document.getElementById("listaPerguntas");

    // 4. O loop agora percorre a lista combinada
    perguntasExtras.forEach((p, i) => {
        container.innerHTML += `<div class="card"><strong>${i+2}. ${p}</strong><br><br>
            <input type="radio" name="p${i+1}" value="Sim"> Sim &nbsp;&nbsp;
            <input type="radio" name="p${i+1}" value="N칚o"> N칚o</div>`;
    });

    let fotosBase64 = [];


function limparRegistrosAntigos() {
    const hist = JSON.parse(localStorage.getItem("historicoChecklist")) || [];
    if (hist.length === 0) return;

    const trintaDiasAtras = new Date();
    trintaDiasAtras.setDate(trintaDiasAtras.getDate() - 30);

    // Filtra para manter apenas registros com menos de 30 dias
    const histFiltrado = hist.filter(reg => {
        const dataReg = new Date(reg.data);
        return dataReg >= trintaDiasAtras;
    });

    // Atualiza o armazenamento se algo foi removido
    if (histFiltrado.length !== hist.length) {
        localStorage.setItem("historicoChecklist", JSON.stringify(histFiltrado));
        console.log("Limpeza de 30 dias conclu칤da no checklist.");
    }
}

function carregarDadosExistentes() {
    // Chama a limpeza autom치tica primeiro
    limparRegistrosAntigos(); 

    const hist = JSON.parse(localStorage.getItem("historicoChecklist")) || [];
    
    // Tenta encontrar o registro espec칤fico desta m치quina hoje
    const registroMaq = hist.find(r => r.loja === loja && r.equipamento === maquina && r.data === dataHoje);
    
    // Busca o 칰ltimo t칠cnico que salvou qualquer checklist hoje para auto-preencher o nome
    const ultimoRegistroDoDia = hist.filter(r => r.data === dataHoje).pop();

    if (registroMaq) {
        document.getElementById("tecnico").value = registroMaq.responsavel;
        document.getElementById("comentarioFoto").value = registroMaq.comentarioFoto;
        registroMaq.itens.forEach((item, i) => {
            const radios = document.getElementsByName(`p${i}`);
            for (let r of radios) { if (r.value === item.resposta) r.checked = true; }
        });
        if (registroMaq.fotos) {
            fotosBase64 = registroMaq.fotos;
            renderizarGaleria();
        }
    } else if (ultimoRegistroDoDia) {
        // Se a m치quina n칚o tem checklist, mas algu칠m j치 trabalhou hoje, preenche o nome do t칠cnico
        document.getElementById("tecnico").value = ultimoRegistroDoDia.responsavel;
    }
}



    // --- FUN칂츾O DE COMPRESS츾O DE IMAGEM ---
    async function processarFotos(input) {
        const loading = document.getElementById("loading");
        loading.style.display = "block";
        
        const files = Array.from(input.files);
        for (let file of files) {
            const compressed = await compressImage(file);
            fotosBase64.push(compressed);
        }
        
        renderizarGaleria();
        loading.style.display = "none";
        input.value = ""; // Limpa o input para permitir novas fotos
    }

    function compressImage(file) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (event) => {
                const img = new Image();
                img.src = event.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const MAX_WIDTH = 800; // Reduz a largura para 800px (칩timo para mobile)
                    const scaleSize = MAX_WIDTH / img.width;
                    canvas.width = MAX_WIDTH;
                    canvas.height = img.height * scaleSize;

                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    
                    // Comprime a qualidade para 0.7 (70%)
                    const dataUrl = canvas.toDataURL('image/jpeg', 0.7);
                    resolve(dataUrl);
                };
            };
        });
    }

    function renderizarGaleria() {
        const galeria = document.getElementById("galeria");
        galeria.innerHTML = "";
        fotosBase64.forEach((src, index) => {
            const div = document.createElement("div");
            div.className = "thumb-container";
            div.innerHTML = `
                <img src="${src}" class="thumb">
                <button class="btn-del" onclick="removerFoto(${index})">X</button>
            `;
            galeria.appendChild(div);
        });
    }

    function removerFoto(index) {
        fotosBase64.splice(index, 1);
        renderizarGaleria();
    }


function salvar() {
    const tec = document.getElementById("tecnico").value;
    if(!tec) return alert("Preencha o nome do t칠cnico.");

    const todasP = ["Status Geral", ...perguntasExtras];
    const itens = [];

    // VALIDA칂츾O: Verifica se todas as perguntas foram respondidas
    for (let i = 0; i < todasP.length; i++) {
        const rads = document.getElementsByName(`p${i}`);
        let selecionado = null;
        rads.forEach(r => { if(r.checked) selecionado = r.value; });

        if (selecionado === null) {
            return alert(`Por favor, responda a pergunta: ${todasP[i]}`);
        }
        itens.push({ pergunta: todasP[i], resposta: selecionado });
    }

    // CRIA칂츾O DO REGISTO
    const novoRegistro = {
        data: dataHoje, 
        loja: loja, 
        equipamento: maquina, 
        responsavel: tec,
        comentarioFoto: document.getElementById("comentarioFoto").value,
        fotos: fotosBase64,
        itens: itens
    };

    let hist = JSON.parse(localStorage.getItem("historicoChecklist")) || [];
    
    // Remove duplicados do mesmo dia/m치quina antes de salvar o novo
    const index = hist.findIndex(r => r.loja === loja && r.equipamento === maquina && r.data === dataHoje);
    if (index !== -1) hist.splice(index, 1);
    
    hist.push(novoRegistro);

    try {
        localStorage.setItem("historicoChecklist", JSON.stringify(hist));
        alert("Checklist atualizado com sucesso!");
        window.location.replace("index.html");
    } catch (e) {
        alert("Erro: O limite de mem칩ria foi atingido. Remova fotos ou limpe o hist칩rico.");
    }
}
</script>
</body>
</html>